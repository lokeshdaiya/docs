import { Component, Inject } from '@angular/core';
import { HttpClient } from '@angular/common/http';

// import { ToastrService } from 'ngx-toastr';
declare const saveDocument: any;
declare const loadDocument: any;
declare const insertField: any;
declare const readDocument: any;
declare const readDocument2: any;
declare const deleteField: any;
declare const loadData: any;
declare const changeData: any;

declare const downloadDocument: any;
declare const scrollPage: any;




@Component({
  selector: 'app-root',
  templateUrl: './app.component.html',
  styleUrls: ['./app.component.css']
})
export class AppComponent {
  title = 'my-app';
  public _http: HttpClient;
  public documentName: string;
  public docs: Documentdrp[];
  showHideTab: any = 'Hide';
  documentData: any = "";
  showSignatueDoc: any = false;
  resultJson: any;
  popupData: any;
  public selectedDoc: string;
  panelOpenState = false;
  constructor(http: HttpClient) {
    this._http = http;

  }
  
  ngOnInit() {
    var baseUrl = 'http://40.87.9.103:8080/';
    this.popupData = {
      'property': ['Text Control1, LLC', 'Text Control2, LLC']
    }
    // this.popupData = [
    //   {
    //     "Name": [
    //       { "val1": "Text Control1, LLC" }, { "val2": "Text Control2, LLC" }]
    //   }
    // ]
    //---------------------Load field Names--------------------------------------------------------
    // get data source structure from Web API endpoint 'LoadData'
    this._http.get<any>(baseUrl + 'api/DocApi/loaddata').subscribe(result => {
      console.log(result, 'result');
      this.resultJson = result;
      // this.resultJson = [
      //   {
      //     "Id": 1,
      //     "Customer": {
      //       "Id": 1,
      //       "Name": "Text Control1, LLC",
      //       "Street": "6926 Shannon-Willow Rd",
      //       "ZipCode": "28226",
      //       "City": "Charlotte",
      //       "Country": "United States",
      //       "Contacts": [
      //         {
      //           "Id": 1,
      //           "Name": "Paul De Wright"
      //         }
      //       ]
      //     }
      //   }
      // ]
      // call JavaScript function from injected 'textcontrol.js'
      loadData(this.resultJson);

    }, error => console.error(error));
    var checkExist = setInterval(function () {
      if (document.getElementById('ribbonGroupClipboard') != null) {
        var sSaveBtn = '<div class="ribbon-group" id="newGroup"> \
        <div class="ribbon-group-content"> \
        <div id="downloadButton" class="ribbon-button ribbon-button-big"> \
        <div class="ribbon-button-big-image-container"> \
        <img src="./assets/images/save-button.jpg" class="ribbon-button-big-image" /> \
        </div> \
        <div class="ribbon-button-big-label-container"> \
        <p class="ribbon-button-label">Download Document</p> \
        </div> \
        </div> \
        </div> \
        <div class="ribbon-group-label-container"> \
        <p class="ribbon-group-label">File</p> \
        </div></div>';

        var sLoadBtn = '<div class="ribbon-group" id="newGroup"> \
        <div class="ribbon-group-content"> \
        <div id="loadButton" class="ribbon-button ribbon-button-big"> \
        <div class="ribbon-button-big-image-container"> \
        <img src="./assets/images/load-document.png" class="ribbon-button-big-image" /> \
        </div> \
        <div class="ribbon-button-big-label-container"> \
        <p class="ribbon-button-label">Load Document</p> \
        </div> \
        </div> \
        </div> \
        <div class="ribbon-group-label-container"> \
        <p class="ribbon-group-label">File</p> \
        </div></div>';

        // add the new button and ribbon group using HTML
        document.getElementById('ribbonGroupClipboard').insertAdjacentHTML(
          'beforebegin', sSaveBtn);

        document.getElementById('ribbonGroupClipboard').insertAdjacentHTML(
          'beforebegin', sLoadBtn);
        document.getElementById("downloadButton").addEventListener(
          "click",
          function () { downloadDocument(); });
        document.getElementById("loadButton").addEventListener(
          "click",
          function () { loadDocument(); });
        clearInterval(checkExist);
      }
    }, 100);
    this.GetFiles(this._http);
  }
  private GetFiles(http: HttpClient) {
    http.get<any>('http://40.87.9.103:8080/api/docapi/GetFiles').subscribe(result => {
      this.docs = result;
      console.error(result);
    }, error => console.error(error));
  }
  toggleRibbonElement(e, group, tab, highlight) {

    if (tab != null) {
      if (e.target.checked === true) {
        document.getElementById(group).style.display = 'none';
        this.showHideTab = 'Show';
      }
      else {
        document.getElementById(group).style.display = 'block';
        this.showHideTab = 'Hide';
      }

    }
  }

  addButton() {
  }

  async onClickSave() {
    // saveDocument();
    let postDocument: MergedDocument = {
      name: this.documentName,
      document: await saveDocument()
    };
    console.log(saveDocument(), 'save');

    //return false;
    // post the document to endpoint 'MergeDocument'
    if (confirm("Are you sure you want to save this document")) {
      this._http.post<MergedDocument>('http://40.87.9.103:8080/api/docapi/savedocument', postDocument).subscribe(result => {

        // load the results into TXTextControl
        loadDocument(result);
        // this.toastr.success('Document Saved successfully', 'Success', {
        //   timeOut: 2000
        // });

      }, error => console.error(error));

    }


  }

  async onClickLoadDocument() {
    await this.signDoc();
    let fileName: MergedDocument = {
      name: this.selectedDoc,
      document: this.documentName
    };
    ///Load document from server based on file Name
    // var result1 = "CAcBAA4AAAABAD42AAAXAAIASQBuAHMAZQByAHQAIABTAGkAZwBuAGEAdAB1AHIAZQAgAGgAZQByAGUACgAKAAAA+DUAAAEAAQADAAEAAAAAAAAAAADfhwEAAQAXAAAAAAAAQAAAAAAAAABQOP8AAAAAAACQAQAAAAAAAAIiQXJpYWwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAEAFgABABcAFwABABgAGAAAAAAAAAAAAAAAAABkACACDwAAAAFuBAHcCAFKDQG4EQEmFgGUGgECHwFwIwHeJwFMLAG6MAEoNQGWOQEEPgAAAAAAAAAAAAAAAAAAAABBAHIAaQBhAGwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOQEAAABAAEACQYAAQAAAC4AAP//AAAAALcAAQAAAABAAAAAUAEAAAAJBAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAeAAwAYAAAAAAB1AAAAbgoAAN0CAABkAGQAAAAAAAAAAAAAAAAAAAACAOkDAAAAAAAAAAAONAAACAcBAA4AAAAAAAAAAAAxAAIAUwBpAGcAbgBlAGQAIABiAHkAOgAgAGgAYQBzAG0AYQB0AGEAbABpAAoAAQAKADgALwAyADAALwAyADAAMgAwACAANQA6ADEAMAA6ADIANAAgAEEATQAgAFUAVABDAAoACgAAACgyAAACAAIABQABAAEAAQABAAAAH4cBAAEAMAAAAAAAAEAAAAAAAAAAUAIAMQABAAAAAAAAQAAAAAAAAABQnP8AAAAAAACQAQAAAAAAAAIiQXJpYWwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACw/wAAAAAAAJABAAAAAAAAAiJBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAQAVAAEAFgAXAAEAGAAwAAEAMQAxAAEAMgAyAACAAAAAAAAAAAAAAGQAIAIPAAAAAW4EAdwIAUoNAbgRASYWAZQaAQIfAXAjAd4nAUwsAbowASg1AZY5AQQ+AAAAAAAAZABkAFIIOwEAAOguAAAAANwA6C4AAAAAAAAAAAAAAAAAAGJtcAAAAEJNzi4AAAAAAAA2AAAAKAAAAI4AAAAVAAAAAQAgAAAAAAAAAAAAxA4AAMQOAAAAAAAAAAAA";
    // var result2 = "AP//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8PDw/7q6uv+6urr/urq6/7q6uv+6urr/8PDw////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////39/f/0tLS/9ubm7/bm5u/25ubv9ubm7/bm5u/xwcHP/g4OD/////////////////////////////////////////////////////////////////////////////";
    // var result3 = "/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5GRkf+kpKT//////////////////////8zMzP9OTk7/+vr6//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////7+/v8+Pj7/4+Pj/////////////v7+/8fHx/86Ojr/4uLi///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////p6en/SkpK////////////+/v7/4mJif9GRkb/0tLS////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////4eHh/0FBQf/+/v7/srKy/0hISP93d3f/9vb2/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+Hh4f8pKSn/SUlJ/1tbW//a2tr////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8/Pz/1NTU/4uLi/83Nzf/ISEh/8PDw//+/v7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////b29v+8vLz/Q0ND/1NTU/+VlZX/zMzM/0FBQf/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5+fn/x8fH/3Nzc/81NTX/ZWVl/83Nzf///////////+Hh4f9BQUH/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1NTU/4uLi/9ISEj/NDQ0/1paWv+rq6v/+Pj4///////////////////////x8fH/Pz8////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////q6ur/QkJC/0xMTP+goKD/39/f//39/f///////////////////////////////////////////1FRUf/j4+P//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////f39//Hx8f/+/v7///////////////////////////////////////////////////////////+ampr/nJyc////////////////////////////////////////////////////////////////////////////////////////////////////////";
    // var result4 = "////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////5OTk/0FBQf/6+vr///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////98fHz/paWl////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////tra2/4SEhP/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8/Pz/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////";
    // var result5 = "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";
    // var result = result1 + result2 +result3+ result4+ result5;
    // this.onChangeLoad(result);
    // return false;

    this._http.post<MergedDocument>('http://40.87.9.103:8080/api/docapi/Loaddocument', fileName).subscribe(result => {

      // load the results into TXTextControl
      //TXTextControl.streamType.InternalUnicodeFormat
      //let data: string = "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"
      //loadDocument(data);
      loadDocument(result.document);
      this.onChangeLoad(result.document);
      //this.documentData = result.document;

    }, error => console.error(error));

  }
  scrollPage(page) {
    scrollPage(page);
  }
  onClickLoad() {
    loadDocument();
    console.log('saveDocument:any[]')
  }

  insertMergeField(name) {
    insertField(name);
  }
  deleteMergeField(name) {
    deleteField(name);
  }

  openDocument(e) {
    readDocument(e);

  }

  onChangeLoad(event: any) {
    readDocument2(event, this.selectedDoc);
  }

  async signDoc() {
    document.getElementById('signViewer').style.display = 'block';
    document.getElementById('editorViewer').style.display = 'block';
  }

  // openModal(template: any) {
  //   this.modalRef = this.modalService.show(template, { class: 'modal-sm' });
  // }
  // confirm(index, field): void {
  //   console.log('yes');

  // }

  async onClickMergeDocument() {

    // get the saved document from TXTextControl
    let postDocument2: MergedDocument = {
      name: this.documentName,
      document: await saveDocument()
    };

    // post the document to endpoint 'MergeDocument'
    this._http.post<MergedDocument>('http://40.87.9.103:8080/api/docapi/mergedocument', postDocument2).subscribe(result => {

      // load the results into TXTextControl
      loadDocument(result.document);

    }, error => console.error(error));

  }

  openPopup() {
    document.getElementById('exampleModal').style.display = 'block';
    document.getElementById('exampleModal').style.opacity = '1';
  }

  popupValChange(val) {
    console.log(val);
    var newVal = val.split('/');
    var keytoChange = newVal[1];
    var valtoChange = newVal[0];
    console.log(keytoChange, 'keyToChange');

    for (var i = 0; i < this.resultJson.length; i++) {
      this.resultJson[i][keytoChange] = valtoChange;
      changeData(this.resultJson);
    }
    document.getElementById('exampleModal').style.display = 'none';
    document.getElementById('exampleModal').style.opacity = '0';
  }
}




interface MergedDocument {
  name: string;
  document: string;
}
interface Documentdrp {
  Name: string;
  ID: number;
}